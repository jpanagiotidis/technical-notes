AUI.add("liferay-portlet-dynamic-data-mapping",function(k){var p=k.Array;var d=k.Lang;var n=k.FormBuilderField;var o=k.instanceOf;var h=d.isObject;var m=AUI.defaults.FormValidator;var r=["label","predefinedValue","tip"];var i={checkbox:["readOnly","required"],"ddm-fileupload":["predefinedValue"],DEFAULT:["readOnly"]};var j="";var q={attributeList:j,nodeName:j};var e="]]>";var a="<![CDATA[";var b=" ";var f="<{nodeName}{attributeList}></{nodeName}>";var g={dataType:1,name:1,options:1,type:1};m.STRINGS.structureFieldName='\u03a0\u03b1\u03c1\u03b1\u03ba\u03b1\u03bb\u03ce\u0020\u03b5\u03b9\u03c3\u03ac\u03b3\u03b5\u03c4\u03b5\u0020\u03bc\u03cc\u03bd\u03bf\u0020\u03c4\u03bf\u03c5\u03c2\u0020\u03b1\u03bb\u03c6\u03b1\u03bd\u03bf\u03c5\u03bc\u03b5\u03c1\u03b9\u03ba\u03bf\u03cd\u03c2\u0020\u03c7\u03b1\u03c1\u03b1\u03ba\u03c4\u03ae\u03c1\u03b5\u03c2\u002e';m.RULES.structureFieldName=function(s){return(/^[\w\-]+$/).test(s)};var c=k.Component.create({ATTRS:{localizationMap:{validator:h,value:{}}},NAME:"availableField",EXTENDS:k.FormBuilderAvailableField});k.LiferayAvailableField=c;var l=k.Component.create({ATTRS:{availableFields:{validator:h,valueFn:function(){return l.AVAILABLE_FIELDS.DEFAULT}},portletNamespace:{value:j},portletResourceNamespace:{value:j},translationManager:{validator:h,value:{}},validator:{setter:function(u){var s=this;var t=k.merge({rules:{name:{required:true,structureFieldName:true}},fieldStrings:{name:{required:'\u0391\u03c5\u03c4\u03cc\u03c2\u0020\u03c4\u03bf\u0020\u03c0\u03b5\u03b4\u03af\u03bf\u0020\u03b5\u03af\u03bd\u03b1\u03b9\u0020\u03c5\u03c0\u03bf\u03c7\u03c1\u03b5\u03c9\u03c4\u03b9\u03ba\u03cc\u002e'}}},u);return t},value:{}},strings:{value:{addNode:'\u03a0\u03c1\u03bf\u03c3\u03b8\u03ad\u03c3\u03c4\u03b5\u0020\u03c4\u03bf\u03bd\u0020\u03c4\u03bf\u03bc\u03ad\u03b1',button:'\u039a\u03bf\u03c5\u03bc\u03c0\u03af',buttonType:'\u0062\u0075\u0074\u0074\u006f\u006e\u002d\u0074\u0079\u0070\u0065',cancel:'\u0386\u03ba\u03c5\u03c1\u03bf',deleteFieldsMessage:'\u03a3\u03af\u03b3\u03bf\u03c5\u03c1\u03b1\u0020\u03b8\u03ad\u03bb\u03b5\u03c4\u03b5\u0020\u03bd\u03b1\u0020\u03b4\u03b9\u03b1\u03b3\u03c1\u03ac\u03c8\u03b5\u03c4\u03b5\u0020\u03c4\u03b7\u03bd\u0020\u03b5\u03c0\u03b9\u03bb\u03b5\u03b3\u03bc\u03ad\u03bd\u03b7\u0020\u03ba\u03b1\u03c4\u03b1\u03c7\u03ce\u03c1\u03b7\u03c3\u03b7\u003b',duplicateMessage:'\u0064\u0075\u0070\u006c\u0069\u0063\u0061\u0074\u0065',editMessage:'\u0395\u03c0\u03b5\u03be\u03b5\u03c1\u03b3\u03b1\u03c3\u03af\u03b1',label:'\u0395\u03c4\u03b9\u03ba\u03ad\u03c4\u03b1\u0020\u03c4\u03bf\u03bc\u03ad\u03c9\u03bd',large:'\u039c\u03b5\u03b3\u03b1\u03bb\u03cd\u03c4\u03b5\u03c1\u03bf\u03c2',medium:'\u039c\u03ad\u03c3\u03bf',multiple:'\u03a0\u03bf\u03bb\u03bb\u03b1\u03c0\u03bb\u03ac\u03c3\u03b9\u03bf\u03c2',name:'\u038c\u03bd\u03bf\u03bc\u03b1',no:'\u038c\u03c7\u03b9',options:'\u0395\u03c0\u03b9\u03bb\u03bf\u03b3\u03ad\u03c2',predefinedValue:'\u03a0\u03c1\u03bf\u03ba\u03b1\u03b8\u03bf\u03c1\u03b9\u03c3\u03bc\u03ad\u03bd\u03b7\u0020\u03b1\u03be\u03af\u03b1',propertyName:'\u038c\u03bd\u03bf\u03bc\u03b1\u0020\u03b9\u03b4\u03b9\u03bf\u03ba\u03c4\u03b7\u03c3\u03af\u03b1\u03c2',required:'\u0391\u03c0\u03b1\u03b9\u03c4\u03bf\u03cd\u03bc\u03b5\u03bd\u03bf\u03c2',reset:'\u0395\u03c0\u03b1\u03bd\u03b1\u03c6\u03bf\u03c1\u03ac',save:'\u0391\u03c0\u03bf\u03b8\u03ae\u03ba\u03b5\u03c5\u03c3\u03b7',settings:'\u03a1\u03c5\u03b8\u03bc\u03af\u03c3\u03b5\u03b9\u03c2',showLabel:'\u03a0\u03b1\u03c1\u03bf\u03c5\u03c3\u03b9\u03ac\u03c3\u03c4\u03b5\u0020\u03b5\u03c4\u03b9\u03ba\u03ad\u03c4\u03b1',small:'\u039c\u03b9\u03ba\u03c1\u03cc\u03c2',submit:'\u039a\u03b1\u03c4\u03b1\u03c7\u03ce\u03c1\u03b7\u03c3\u03b7',tip:'\u0386\u03ba\u03c1\u03b7',type:'\u03a4\u03cd\u03c0\u03bf\u03c2',value:'\u0391\u03be\u03af\u03b1',width:'\u03a0\u03bb\u03ac\u03c4\u03bf\u03c2',yes:'\u039d\u03b1\u03b9'}}},EXTENDS:k.FormBuilder,NAME:"liferayformbuilder",prototype:{initializer:function(){var s=this;s.LOCALIZABLE_FIELD_ATTRS=k.Array(r);s.MAP_HIDDEN_FIELD_ATTRS=k.clone(i);var t=s.translationManager=new Liferay.TranslationManager(s.get("translationManager"));s.after("render",function(u){t.render()});s.addTarget(Liferay.Util.getOpener().Liferay)},bindUI:function(){var s=this;l.superclass.bindUI.apply(s,arguments);s.translationManager.after("editingLocaleChange",s._afterEditingLocaleChange,s)},createField:function(){var s=this;var t=l.superclass.createField.apply(s,arguments);t.set("strings",s.get("strings"));return t},getXSD:function(){var s=this;var v=[];var u=s.translationManager;var w=u.get("editingLocale");s._updateFieldsLocalizationMap(w);var t=s._createDynamicNode("root",{"available-locales":u.get("availableLocales").join(),"default-locale":u.get("defaultLocale")});v.push(t.openTag);s.get("fields").each(function(y,x,z){s._appendStructureTypeElementAndMetaData(y,v)});v.push(t.closeTag);return v.join(j)},getFieldLocalizedValue:function(x,u,t){var s=this;var w=x.get("localizationMap");var v=k.Object.getValue(w,[t,u])||x.get(u);return s.normalizeValue(v)},normalizeValue:function(t){var s=this;if(d.isUndefined(t)){t=j}return t},_afterEditingLocaleChange:function(u){var s=this;var t=u.newVal;var v=u.prevVal;s._updateFieldsLocalizationMap(v);s._syncFieldsLocaleUI(t)},_appendStructureChildren:function(u,t){var s=this;u.get("fields").each(function(w,v,x){s._appendStructureTypeElementAndMetaData(w,t)})},_appendStructureFieldOptionsBuffer:function(v,t){var s=this;var u=v.get("options");if(u){p.each(u,function(x,w,y){var z=s._createDynamicNode("dynamic-element",{name:s._formatOptionsKey(x.label),type:"option",value:Liferay.Util.escapeHTML(x.value)});t.push(z.openTag);s._appendStructureOptionMetaData(x,t);t.push(z.closeTag)})}},_appendStructureOptionMetaData:function(u,t){var s=this;var v=u.localizationMap;var w=s._createDynamicNode("entry",{name:"label"});k.each(v,function(z,x,B){if(h(z)){var y=s._createDynamicNode("meta-data",{locale:x});var A=s.normalizeValue(z.label);t.push(y.openTag,w.openTag,a+A+e,w.closeTag,y.closeTag)}})},_appendStructureTypeElementAndMetaData:function(w,u){var t=this;var v=t._createDynamicNode("dynamic-element",{dataType:w.get("dataType"),fieldNamespace:w.get("fieldNamespace"),name:encodeURI(w.get("name")),type:w.get("type")});u.push(v.openTag);t._appendStructureFieldOptionsBuffer(w,u);t._appendStructureChildren(w,u);var s=t.translationManager.get("availableLocales");p.each(s,function(x,D,B){var z=t._createDynamicNode("meta-data",{locale:x});u.push(z.openTag);p.each(w.getProperties(),function(E,J,I){var F=E.attributeName;if(!g[F]){var H=t._createDynamicNode("entry",{name:F});var G=t.getFieldLocalizedValue(w,F,x);if((F==="predefinedValue")&&o(w,k.FormBuilderMultipleChoiceField)){G=k.JSON.stringify(p(G))}u.push(H.openTag,a+G+e,H.closeTag)}});if(o(w,k.FormBuilderTextField)){var A=t._createDynamicNode("entry",{name:"fieldCssClass"});var y=w.get("width");var C=k.getClassName("w"+y);u.push(A.openTag,a+C+e,A.closeTag)}u.push(z.closeTag)});u.push(v.closeTag)},_createDynamicNode:function(w,t){var s=this;var u=[];var v=[];if(!w){w="dynamic-element"}q.attributeList=j;q.nodeName=w;if(t){k.each(t,function(y,x,z){if(y!==undefined){u.push([x,'="',y,'" '].join(j))}});q.attributeList=b+u.join(j)}v=d.sub(f,q);v=v.replace(/\s?(>)(<)/,"$1$1$2$2").split(/></);return{closeTag:v[1],openTag:v[0]}},_formatOptionsKey:function(t){var s=this;t=k.Text.AccentFold.fold(t);k.each(t,function(v,u,w){if(!k.Text.Unicode.test(v,"L")&&!k.Text.Unicode.test(v,"N")){t=t.replace(v,b)}});return t.replace(/ /g,"_")},_setAvailableFields:function(u){var t=this;var s=[];p.each(u,function(w,v,x){s.push(k.instanceOf(w,k.AvailableField)?w:new k.LiferayAvailableField(w))});return s},_syncFieldOptionsLocaleUI:function(v,t){var s=this;var u=v.get("options");p.each(u,function(y,x,A){var z=y.localizationMap;if(h(z)){var w=z[t];if(h(w)){y.label=w.label}}});v.set("options",u)},_syncFieldsLocaleUI:function(u,t){var s=this;t=t||s.get("fields");t.each(function(z,x,w){if(o(z,k.FormBuilderMultipleChoiceField)){s._syncFieldOptionsLocaleUI(z,u)}var y=z.get("localizationMap");var v=y[u];if(h(y)&&h(v)){p.each(s.LOCALIZABLE_FIELD_ATTRS,function(B,A,C){z.set(B,v[B])});s._syncUniqueField(z)}if(s.editingField===z){s.propertyList.set("recordset",z.getProperties())}s._syncFieldsLocaleUI(u,z.get("fields"))})},_updateFieldOptionsLocalizationMap:function(v,t){var s=this;var u=v.get("options");p.each(u,function(x,w,z){var y=x.localizationMap;if(!h(y)){y={}}y[t]={label:x.label};x.localizationMap=y});v.set("options",u)},_updateFieldsLocalizationMap:function(u,t){var s=this;t=t||s.get("fields");t.each(function(w,v,y){var x={};x[u]=w.getAttrs(s.LOCALIZABLE_FIELD_ATTRS);w.set("localizationMap",k.mix(x,w.get("localizationMap")));if(o(w,k.FormBuilderMultipleChoiceField)){s._updateFieldOptionsLocalizationMap(w,u)}s._updateFieldsLocalizationMap(u,w.get("fields"))})}}});l.DEFAULT_ICON_CLASS="aui-form-builder-field-icon aui-form-builder-field-icon-default";l.AVAILABLE_FIELDS={DEFAULT:[{fieldLabel:'\u039a\u03bf\u03c5\u03bc\u03c0\u03af',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-button",label:'\u039a\u03bf\u03c5\u03bc\u03c0\u03af',type:"button"},{fieldLabel:'\u03a0\u03b1\u03c1\u03ac\u03b8\u03c5\u03c1\u03bf\u0020\u03b5\u03bb\u03ad\u03b3\u03c7\u03bf\u03c5',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-checkbox",label:'\u03a0\u03b1\u03c1\u03ac\u03b8\u03c5\u03c1\u03bf\u0020\u03b5\u03bb\u03ad\u03b3\u03c7\u03bf\u03c5',type:"checkbox"},{fieldLabel:'\u03a4\u03bf\u03bc\u03b5\u03af\u03c2',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-fieldset",label:'\u03a4\u03bf\u03bc\u03b5\u03af\u03c2',type:"fieldset"},{fieldLabel:'\u0391\u03bd\u03ad\u03b2\u03b1\u03c3\u03bc\u03b1\u0020\u0391\u03c1\u03c7\u03b5\u03af\u03bf\u03c5',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-fileupload",label:'\u0391\u03bd\u03ad\u03b2\u03b1\u03c3\u03bc\u03b1\u0020\u0391\u03c1\u03c7\u03b5\u03af\u03bf\u03c5',type:"fileupload"},{fieldLabel:'\u03a0\u03b1\u03c1\u03ac\u03b8\u03c5\u03c1\u03bf\u0020\u03ba\u03b5\u03b9\u03bc\u03ad\u03bd\u03bf\u03c5',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-text",label:'\u03a0\u03b1\u03c1\u03ac\u03b8\u03c5\u03c1\u03bf\u0020\u03ba\u03b5\u03b9\u03bc\u03ad\u03bd\u03bf\u03c5',type:"text"},{fieldLabel:'\u03a0\u03b5\u03c1\u03b9\u03bf\u03c7\u03ae\u0020\u03ba\u03b5\u03b9\u03bc\u03ad\u03bd\u03c9\u03bd\u0020\u0028\u0048\u0054\u004d\u004c\u0029',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-textarea",label:'\u03a0\u03b5\u03c1\u03b9\u03bf\u03c7\u03ae\u0020\u03ba\u03b5\u03b9\u03bc\u03ad\u03bd\u03c9\u03bd\u0020\u0028\u0048\u0054\u004d\u004c\u0029',type:"textarea"},{fieldLabel:'\u03a1\u03b1\u03b4\u03b9\u03bf\u0020\u03ba\u03bf\u03c5\u03bc\u03c0\u03b9\u03ac',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-radio",label:'\u03a1\u03b1\u03b4\u03b9\u03bf\u0020\u03ba\u03bf\u03c5\u03bc\u03c0\u03b9\u03ac',type:"radio"},{fieldLabel:'\u0395\u03c0\u03b9\u03bb\u03ad\u03be\u03c4\u03b5\u0020\u03c4\u03b7\u03bd\u0020\u03b5\u03c0\u03b9\u03bb\u03bf\u03b3\u03ae',iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-select",label:'\u0395\u03c0\u03b9\u03bb\u03ad\u03be\u03c4\u03b5\u0020\u03c4\u03b7\u03bd\u0020\u03b5\u03c0\u03b9\u03bb\u03bf\u03b3\u03ae',type:"select"}],DDM_STRUCTURE:[{hiddenAttributes:i.checkbox,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-checkbox",label:'\u03a4\u03bf\u03c5\u0020\u039c\u03c0\u03bf\u03c5\u03bb',type:"checkbox"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-date",label:'\u0397\u03bc\u03b5\u03c1\u03bf\u03bc\u03b7\u03bd\u03af\u03b1',type:"ddm-date"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-decimal",label:'\u0394\u03b5\u03ba\u03b1\u03b4\u03b9\u03ba\u03cc\u03c2',type:"ddm-decimal"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-document",label:'\u0388\u03b3\u03b3\u03c1\u03b1\u03c6\u03b1\u0020\u03ba\u03b1\u03b9\u0020\u006d\u0065\u0064\u0069\u0061',type:"ddm-documentlibrary"},{hiddenAttributes:i["ddm-fileupload"],iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-fileupload",label:'\u0391\u03bd\u03ad\u03b2\u03b1\u03c3\u03bc\u03b1\u0020\u0391\u03c1\u03c7\u03b5\u03af\u03bf\u03c5',type:"ddm-fileupload"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-integer",label:'\u0391\u03ba\u03ad\u03c1\u03b1\u03b9\u03bf\u03c2\u0020\u03b1\u03c1\u03b9\u03b8\u03bc\u03cc\u03c2',type:"ddm-integer"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-number",label:'\u0391\u03c1\u03b9\u03b8\u03bc\u03cc\u03c2',type:"ddm-number"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-radio",label:'\u0052\u0061\u0064\u0069\u006f',type:"radio"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-select",label:'\u0395\u03c0\u03b9\u03bb\u03ad\u03be\u03c4\u03b5',type:"select"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-text",label:'\u039a\u03b5\u03af\u03bc\u03b5\u03bd\u03bf',type:"text"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-textarea",label:'\u03a0\u03b1\u03c1\u03ac\u03b8\u03c5\u03c1\u03bf\u0020\u03ba\u03b5\u03b9\u03bc\u03ad\u03bd\u03bf\u03c5',type:"textarea"}],DDM_TEMPLATE:[{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-paragraph",label:'\u03a0\u03b1\u03c1\u03ac\u03b3\u03c1\u03b1\u03c6\u03bf\u03c2',type:"ddm-paragraph"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-separator",label:'\u0394\u03b9\u03b1\u03c7\u03c9\u03c1\u03b9\u03c3\u03c4\u03ae\u03c2',type:"ddm-separator"},{hiddenAttributes:i.DEFAULT,iconClass:"aui-form-builder-field-icon aui-form-builder-field-icon-fieldset",label:'\u03a4\u03bf\u03bc\u03b5\u03af\u03c2',type:"fieldset"}]};Liferay.FormBuilder=l},"",{requires:["aui-form-builder","aui-form-validator","aui-text","json","liferay-translation-manager"]});